/**
 * @version $Id$
 * @package DJ-MediaTools
 * @subpackage DJ-MediaTools slideshow layout
 * @copyright Copyright (C) 2017 DJ-Extensions.com, All rights reserved.
 * @license DJ-Extensions.com Proprietary Use License
 * @author url: http://dj-extensions.com
 * @author email contact@dj-extensions.com
 * @developer Szymon Woronowski - szymon.woronowski@design-joomla.eu
 *
 */
!function(r){var t=window.DJImageSlideshow=window.DJImageSlideshow||function(t,i){this.options={autoplay:0,transition:"linear",duration:800,delay:3e3,ifade_multiplier:2,wcag:1},this.init(t,i)};t.prototype.init=function(t,i){var e,s=this;(jQuery.extend(s.options,i),s.slider=r("#"+t),s.slider.length)&&(s.slides=s.slider.find(".dj-slide"),s.descriptions=s.slider.find(".dj-slide-desc"),s.current=0,s.pauseAutoplay=0,s.loader=s.slider.find(".dj-loader").first(),s.loading=1,s.visible||(s.visible=1),s.last=s.slides.length-s.slides.length%s.visible,s.last==s.slides.length&&(s.last-=s.visible),s.transition=s.support("transition"),s.transform=!("ifade"!=s.options.slider_type||!s.transition)&&s.support("transform"),s.slides.length&&(s.setEffectsOptions(),s.setSlidesEffects(),s.setNavigation(),s.setIndicators(),s.setSliderEvents(),s.responsive(),s.loadFirstSlide(),r(window).on("resize",function(){clearTimeout(e),e=setTimeout(s.responsive.bind(s),200)}),r(window).on("load",function(){s.responsive(),s.toggleVideo(s.current)})))},t.prototype.setEffectsOptions=function(){var t=this;switch(t.options.slider_type){case"up":t.property="top",t.startEffect={top:t.options.height+t.options.spacing,opacity:0},t.backEffect={top:-1*(t.options.height+t.options.spacing),opacity:0},t.endEffect={top:0,opacity:1};break;case"down":t.property="top",t.startEffect={top:-1*(t.options.height+t.options.spacing),opacity:0},t.backEffect={top:t.options.height+t.options.spacing,opacity:0},t.endEffect={top:0,opacity:1};break;case"left":t.property="left",t.startEffect={left:t.options.width+t.options.spacing},t.backEffect={left:-1*(t.options.width+t.options.spacing)},t.endEffect={left:0};break;case"right":t.property="left",t.startEffect={left:-1*(t.options.width+t.options.spacing)},t.backEffect={left:t.options.width+t.options.spacing},t.endEffect={left:0};break;case"fade":case"ifade":default:t.property="opacity",t.startEffect={opacity:0},t.endEffect={opacity:1}}if(t.options.desc_effect)switch(t.options.desc_effect){case"up":t.desc_property="margin-bottom",t.desc_startEffect={marginBottom:t.options.height+t.options.spacing},t.desc_endEffect={marginBottom:0};break;case"down":t.desc_property="margin-bottom",t.desc_startEffect={marginBottom:-1*(t.options.height+t.options.spacing)},t.desc_endEffect={marginBottom:0};break;case"left":t.desc_property="margin-left",t.desc_startEffect={marginLeft:-1*(t.options.width+t.options.spacing)},t.desc_endEffect={marginLeft:0};break;case"right":t.desc_property="margin-left",t.desc_startEffect={marginLeft:t.options.width+t.options.spacing},t.desc_endEffect={marginLeft:0};break;case"fade":default:t.desc_property="opacity",t.desc_startEffect={opacity:0},t.desc_endEffect={opacity:1}}},t.prototype.loadFirstSlide=function(){var t=this;if(t.slider.find(".dj-slides").first().css("opacity",0),t.options.preload)t.preloadImage(t.current,!1),setTimeout(t.firstSlideLoaded,t.options.preload);else{var i=r(t.slides[t.current]).find("img.dj-image").first(),e=function(t){this.firstSlideLoaded(),t.off("load",e)}.bind(t,i);i.on("load",e),t.preloadImage(t.current,!1)}},t.prototype.firstSlideLoaded=function(){var t=this;t.loader.fadeOut(200),t.slider.find(".dj-slides").first().animate({opacity:1},200),setTimeout(function(){t.autoPlay()},t.options.delay+500),t.preloadImage(t.current+1,!1),t.loading--,t.options.kenburns&&t.slider.addClass("dj-kenburns")},t.prototype.setSlidesEffects=function(){for(var t=this,i=0;i<t.slides.length;i++)i==t.current?r(t.slides[i]).css(t.endEffect):(r(t.slides[i]).css("visibility","hidden"),r(t.slides[i]).css(t.startEffect));if("ifade"==t.options.slider_type){t.images=[];var e=!!t.transform&&t.transform+" "+t.options.duration/2+"ms cubic-bezier(0.190, 1.000, 0.220, 1.000)";for(i=0;i<t.slides.length;i++)t.images[i]=r(t.slides[i]).find(".dj-image"),t.images[i].length&&(e?(t.images[i].css(t.transition,e),i!=t.current&&t.images[i].css(t.transform,"scale("+t.options.ifade_multiplier+")")):t.images[i].css("max-width","none"))}if(t.options.desc_effect)for(i=0;i<t.descriptions.length;i++)i==t.current?r(t.descriptions[i]).css(t.desc_endEffect):(r(t.descriptions[i]).css("visibility","hidden"),r(t.descriptions[i]).css(t.desc_startEffect))},t.prototype.setNavigation=function(){var i=this;i.nextButton=i.slider.find(".dj-navigation .dj-next").first(),i.nextButton.length&&i.nextButton.on("click",function(t){i.nextSlide(),t.preventDefault(),t.stopPropagation()}),i.prevButton=i.slider.find(".dj-navigation .dj-prev").first(),i.prevButton.length&&i.prevButton.on("click",function(t){i.prevSlide(),t.preventDefault(),t.stopPropagation()}),i.playButton=i.slider.find(".dj-navigation .dj-play").first(),i.pauseButton=i.slider.find(".dj-navigation .dj-pause").first(),i.playButton.length&&i.pauseButton.length&&(i.options.autoplay?i.playButton.css("display","none"):i.pauseButton.css("display","none"),i.playButton.on("click",function(t){t.preventDefault(),t.stopPropagation(),i.playSlideshow()}),i.pauseButton.on("click",function(t){t.preventDefault(),t.stopPropagation(),i.pauseSlideshow()}))},t.prototype.playSlideshow=function(){var t=this;t.options.autoplay=1,t.playButton.length&&t.pauseButton.length&&(t.playButton.css("display","none"),t.pauseButton.css("display","block").focus())},t.prototype.pauseSlideshow=function(){var t=this;t.options.autoplay=0,t.playButton.length&&t.pauseButton.length&&(t.pauseButton.css("display","none"),t.playButton.css("display","block").focus())},t.prototype.setIndicators=function(){var e=this;e.indicators=e.slider.find(".dj-indicators .dj-load-button"),e.indicators.length&&e.indicators.each(function(i){indicator=r(this),indicator.on("click",function(t){e.loadSlide(i*e.visible),t.preventDefault(),t.stopPropagation()})})},t.prototype.setSliderEvents=function(){var s=this;s.options.navi_margin<0&&(s.slider.css("padding-left",-1*s.options.navi_margin),s.slider.css("padding-right",-1*s.options.navi_margin));var t=s.slider.find("a[href], input, select, textarea, button");s.options.wcag&&(s.slider.prop("tabindex","0"),t.prop("tabindex","-1")),s.slider.on("mouseenter",function(){s.pauseAutoplay=s.options.pause_autoplay,s.playButton.length&&s.pauseButton.length&&(s.playButton.css("visibility",""),s.pauseButton.css("visibility",""))}).on("mouseleave",function(){s.slider.removeClass("focused"),s.pauseAutoplay=0}),s.options.wcag&&(s.slider.on("focus",function(){s.options.wcag&&(t.removeProp("tabindex"),s.slider.addClass("focused"),s.slider.trigger("mouseenter"),s.pauseAutoplay=1)}).on("keydown",function(t){var i=t.which;37!=i&&39!=i||(39==i?"right"==s.options.slider_type?s.prevSlide():s.nextSlide():"right"==s.options.slider_type?s.nextSlide():s.prevSlide(),s.slider.focus(),t.preventDefault(),t.stopPropagation())}),s.slider.next(".djslideshow-end").prop("tabindex","0").on("focus",function(){t.prop("tabindex","-1"),s.slider.trigger("mouseleave")})),s.slider.djswipe(function(t,i){i.x<50||50<i.y||("left"==t.x?"right"==s.options.slider_type?s.prevSlide():s.nextSlide():"right"==t.x&&("right"==s.options.slider_type?s.nextSlide():s.prevSlide()))}),s.slides.each(function(){var e=r(this);e.find(".video-icon").css("cursor","pointer"),e.find(".play-video").click(function(t){t.preventDefault();var i=r(this).prev("video, iframe");i.length&&(s.playVideo(i),s.pauseSlideshow(),e.find(".video_cover").remove())})})},t.prototype.prevSlide=function(){var t=this;t.current<t.visible?t.loadSlide(t.last):t.loadSlide(t.current-t.visible)},t.prototype.nextSlide=function(){var t=this;t.current>=t.last?t.loadSlide(0):t.loadSlide(t.current+t.visible)},t.prototype.preloadImage=function(t,i){var e=this;if(e.exist(t)){var s=r(e.slides[t]).find("img.dj-image").first();if(!e.slides[t].loaded){if(e.slides[t].loaded=!0,s.removeAttr("src"),i){e.loading++,e.loader.fadeIn(200);var o=function(t,i){1<t.length&&(i=t[1],t=t[0]),e.loading--,e.loading||(e.loader.fadeOut(200),i-=i%e.visible,e.loadSlide(i)),t.off("load",o)}.bind(e,[s,t]);s.on("load",o)}s.data();var n=s.data("sizes"),a=s.data("srcset"),d=s.data("src");s.removeAttr("data-sizes data-srcset data-src"),n&&a?(s.attr("sizes",n),s.attr("srcset",a),picturefill({elements:[s[0]]})):s.attr("src",d)}}},t.prototype.loadSlide=function(t){var i=this;i.current==t||i.loading||(r(i.slides[t]).find("img.dj-image").first().length&&!i.slides[t].loaded?i.preloadImage(t,!0):(i.slide(i.current,t),t<i.slides.length-1&&i.preloadImage(t+1,!1),i.setCurrentSlide(t)))},t.prototype.exist=function(t){return t in this.slides},t.prototype.slide=function(t,i){var e=this;"fade"==e.options.slider_type?(e.loading++,e.exist(t)&&r(e.slides[t]).animate(e.startEffect,e.options.duration,e.options.transition),e.exist(i)&&(r(e.slides[i]).css("visibility","visible"),r(e.slides[i]).animate(e.endEffect,e.options.duration,e.options.transition)),setTimeout(function(t){e.loading--,e.exist(t)&&r(e.slides[t]).css("visibility","hidden")}.bind(e,t),e.options.duration)):"ifade"==e.options.slider_type?(e.loading++,e.transform||(e.exist(t)&&!e.images[t].startWidth&&(e.images[t].startWidth=e.getSize(r(e.images[t])).x,e.images[t].sWidth=e.sliderWidth),e.exist(i)&&!e.images[i].startWidth&&(e.images[i].startWidth=e.getSize(r(e.images[i])).x,e.images[i].sWidth=e.sliderWidth)),e.exist(t)&&(e.transform?r(e.images[t]).css(e.transform,"scale("+e.options.ifade_multiplier+")"):r(e.images[t]).css({width:e.images[t].startWidth}).animate({width:e.options.ifade_multiplier*e.images[t].startWidth},e.options.duration/2,e.options.transition),r(e.slides[t]).animate(e.startEffect,e.options.duration/2,e.options.transition)),setTimeout(function(t,i){1<t.length&&(i=t[1],t=t[0]),e.exist(t)&&(r(e.slides[t]).css("visibility","visible"),e.transform?r(e.images[t]).css(e.transform,"scale(1)"):r(e.images[t]).css({width:e.options.ifade_multiplier*e.images[t].startWidth}).animate({width:e.images[t].startWidth},e.options.duration/2,e.options.transition),r(e.slides[t]).animate(e.endEffect,e.options.duration/2,e.options.transition)),setTimeout(function(t){e.loading--,e.exist(t)&&r(e.slides[t]).css("visibility","hidden")}.bind(e,i),e.options.duration/2)}.bind(e,i,t),e.options.duration/2)):(r(e.slides[i]).css("visibility","visible"),t<=i&&(i<e.last||t-t%e.visible!=0)||i-i%e.visible==0&&t>=e.last?(e.exist(t)&&r(e.slides[t]).css(e.endEffect).animate(e.backEffect,e.options.duration,e.options.transition),e.exist(i)&&r(e.slides[i]).css(e.startEffect).animate(e.endEffect,e.options.duration,e.options.transition)):(e.exist(t)&&r(e.slides[t]).css(e.endEffect).animate(e.startEffect,e.options.duration,e.options.transition),e.exist(i)&&r(e.slides[i]).css(e.backEffect).animate(e.endEffect,e.options.duration,e.options.transition)),setTimeout(function(t){r(e.slides[t]).css("visibility","hidden")}.bind(e,t),e.options.duration)),e.options.desc_effect&&(e.exist(i)&&"fade"!=e.options.slider_type&&"ifade"!=e.options.slider_type&&e.loading++,e.exist(t)&&r(e.descriptions[t]).animate(e.desc_startEffect,e.options.duration/2,e.options.transition),setTimeout(function(t,i){1<t.length&&(i=t[1],t=t[0]),e.exist(i)&&r(e.descriptions[i]).css("visibility","hidden"),e.exist(t)&&(r(e.descriptions[t]).css("visibility","visible"),r(e.descriptions[t]).animate(e.desc_endEffect,e.options.duration/2,e.options.transition),"fade"!=e.options.slider_type&&"ifade"!=e.options.slider_type&&setTimeout(function(){e.loading--}.bind(e),e.options.duration/2))}.bind(e,i,t),e.options.duration/2))},t.prototype.setCurrentSlide=function(t){var i=this;i.slides.removeClass("dj-active"),r(i.slides[t]).addClass("dj-active"),i.indicators.length&&(i.indicators.removeClass("dj-load-button-active"),r(i.indicators[Math.ceil(t/i.visible)]).addClass("dj-load-button-active")),i.playButton.length&&i.pauseButton.length&&(i.playButton.css("visibility","hidden"),i.pauseButton.css("visibility","hidden")),i.toggleVideo(t),i.current=t},t.prototype.autoPlay=function(){var t=this;t.options.autoplay&&!t.pauseAutoplay&&t.nextSlide(),setTimeout(t.autoPlay.bind(t),t.options.delay)},t.prototype.getSize=function(t){var i={};if(t.is(":hidden")){for(var e,s,o=t.parent();o.is(":hidden");)o=(e=o).parent();s=o.width(),e&&(s-=parseInt(e.css("margin-left")),s-=parseInt(e.css("margin-right")),s-=parseInt(e.css("border-left-width")),s-=parseInt(e.css("border-right-width")),s-=parseInt(e.css("padding-left")),s-=parseInt(e.css("padding-right")));var n=t.clone();n.css({position:"absolute",visibility:"hidden","max-width":s}),r(document.body).append(n),i={x:n.width(),y:n.height()},n.remove()}else i={x:t.width(),y:t.height()};return i},t.prototype.responsive=function(){var t=this;if("ifade"==t.options.slider_type&&!t.transform)for(var i=0;i<t.images.length;i++)t.images[i].startWidth&&(t.images[i].iWidth||(t.images[i].iWidth=t.images[i].startWidth),t.images[i].startWidth=t.images[i].iWidth*(newSliderWidth/t.images[i].sWidth),r(t.images[i]).css("width",r(t.images[i]).startWidth));var e=r(window).width();t.slides.each(function(){var t=r(this).find("img.dj-image").first(),i=Math.floor(100*t.width()/e);t.attr("data-sizes")?t.attr("data-sizes",i+"vw"):t.attr("sizes",i+"vw")}),t.slides.css("max-height",r(window).height()),t.slides.each(function(){var t=r(this),i=t.height(),e=t.width(),s=t.find(".video_cover iframe");s.length&&(s=s.first().css({width:"",height:""}),e/i<16/9?s.css({height:i,width:16*i/9+1}):s.css({width:e,height:9*e/16+1}))})},t.prototype.support=function(t){var i=(document.body||document.documentElement).style;if(void 0===i)return!1;if("string"==typeof i[t])return t;v=["Moz","Webkit","Khtml","O","ms","Icab"],pu=t.charAt(0).toUpperCase()+t.substr(1);for(var e=0;e<v.length;e++)if("string"==typeof i[v[e]+pu])return"-"+v[e].toLowerCase()+"-"+t},t.prototype.toggleVideo=function(t){var i=this,e=r(i.slides[i.current]).find(".video_cover video, .video_cover iframe");e.length&&i.pauseVideo(e),(e=r(i.slides[i.current]).find(".full_video")).length&&i.pauseVideo(e),(e=r(i.slides[t]).find(".video_cover video, .video_cover iframe")).length&&i.playVideo(e),(e=r(i.slides[t]).find(".full_video.play")).length&&i.playVideo(e)},t.prototype.pauseVideo=function(t){switch(t.first().data("provider")){case"YouTube":t[0].contentWindow.postMessage('{"event":"command","func":"pauseVideo"}',"*");break;case"Vimeo":t[0].contentWindow.postMessage('{"event":"command","method":"pause"}',"*");break;default:t[0].pause()}},t.prototype.playVideo=function(t){var i=t.first().data("provider");switch(i){case"YouTube":t[0].contentWindow.postMessage('{"event":"command","func":"playVideo"}',"*");break;case"Vimeo":t[0].contentWindow.postMessage('{"event":"command","method":"play"}',"*");break;default:t[0].play()}if(!t.hasClass("play"))switch(i){case"html5":4==t[0].readyState?t.addClass("play"):t[0].addEventListener("canplay",function(){t.addClass("play")});break;default:t.addClass("play")}},r.fn.djswipe=r.fn.djswipe||function(t){var n=!1,a=null,d=null;return $el=r(this),$el.on("touchstart",function(t){n=!0;var i=t.originalEvent.changedTouches||e.originalEvent.touches;a={x:i[0].pageX,y:i[0].pageY}}),$el.on("touchend",function(){n=!1,d&&t(d.direction,d.offset),d=a=null}),$el.on("touchmove",function(t){var i,s,o;n&&(i=t.originalEvent.changedTouches||e.originalEvent.touches,s=i[0].pageX,o=i[0].pageY,d={direction:{x:s>a.x?"right":"left",y:o>a.y?"down":"up"},offset:{x:Math.abs(s-a.x),y:Math.abs(a.y-o)}})}),!0}}(jQuery);